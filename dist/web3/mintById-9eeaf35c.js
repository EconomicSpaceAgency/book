import{g as m}from"../db/invitations-6dcc9f81.js";import{i as c}from"../db/copublishers-5adcc3ec.js";import{t as T}from"../ux/transactionInitiated-830fc9c7.js";import{o as b}from"../ux/openCongratzOverlay-6dc84a1c.js";import{r}from"../ux/waitingForTransactionToInitiate-bc20ade0.js";import{c as f,a as p,b as v,r as w,s as g,h as M}from"../index-0c8d8ac8.js";import{v as h,d as I}from"../validateChoosePrice-895d40c8.js";import{B as k}from"../provider-browser-4e6c2389.js";import{C as A}from"../contract-1c37cfa4.js";import"../db/supabase-bcc39e3c.js";import"../ux/modifyBenefits-6de5ee72.js";import"../ux/blurAndPreventScrolling-0822e332.js";import"../ux/revertTransactionInitiatedAnimation-630d6393.js";import"../provider-jsonrpc-62e4dd44.js";const J=async(t,o,u)=>{const i=await new k(window.ethereum).getSigner(),y="0x3aEa64fD94D8185dF5B0f8da8E313F12951dA848",l=[{inputs:[{internalType:"address",name:"_nftMetadata",type:"address"},{internalType:"address",name:"reservationContractAddress",type:"address"},{internalType:"address",name:"invitationsContractAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"log",type:"string"}],name:"Debugging",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"_alreadyMintedTokenIds",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"newTokenURI",type:"string"}],name:"changeAttributes",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getAlreadyMintedTokenIds",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getInvitationsActive",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPrice1",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPrice2",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getPriceForTokenId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getReservationsActive",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"isOwnerOnlyMode",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"mintBaseTest",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"chosenPrice",type:"uint256"}],name:"mintById",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"invitationId",type:"string"},{internalType:"uint256",name:"chosenPrice",type:"uint256"}],name:"mintByInvitation",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"reservationId",type:"string"},{internalType:"uint256",name:"chosenPrice",type:"uint256"}],name:"mintByReservation",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"nftMetadata",outputs:[{internalType:"contract NFTMetadata",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address payable",name:"_to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"sendViaCall",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_status",type:"bool"}],name:"setInvitationsActive",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_price1",type:"uint256"}],name:"setPrice1",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_price2",type:"uint256"}],name:"setPrice2",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_status",type:"bool"}],name:"setReservationsActive",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"tokenPurchasePrice",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenAddress",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"withdrawERC20",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenAddress",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"withdrawERC721",outputs:[],stateMutability:"nonpayable",type:"function"}];localStorage.setItem("wallet",i.address);const d=new A(y,l,i);try{let e=h(u);f();const n=await d.mintById(t,e,{gasLimit:12e6,value:e});p(),T(t);const s=await n.wait();if(s&&s.status==1){v(t),w(t),g(t);try{const a=await m();localStorage.setItem("invitation",`https://ecsa-book.vercel.app/?invitationId=${a[0].value}`)}catch{console.log("operations with `invitations` storage silently failed...")}try{const a=await c(i.address,t)}catch{console.log("operations with `copublishers` storage silently failed...")}p(),b(o),I(t)}}catch(e){if(e.code=="ACTION_REJECTED"){console.log("Transaction was rejected by the user."),r();return}else if(e.message.includes("wrong chain")||e.message.includes("network mismatch"))console.log("You are on the wrong network. Please switch your network.");else if(e.message.includes("insufficient funds")){console.log("error: ",e),console.log("You do not have enough funds. Consider switching to a network with enough balance.");const n=document.getElementById("tiersErrorMessage");n&&(n.innerHTML="You do not have enough funds to execute the transaction",n.style.display="block");return}else if(e.code=="ACTION_REJECTED"){console.log("Transaction was rejected by the user."),r();return}else console.log("error: ",e),M(t)}};export{J as m};
